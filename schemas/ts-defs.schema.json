{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "BCVE": {
      "additionalProperties": false,
      "description": "A benchmark CVE.\n\nSee bcves/README.md for an in-depth explanation of this type.",
      "properties": {
        "CVE": {
          "$ref": "#/definitions/CVEString",
          "description": "The CVE identifier."
        },
        "CWEs": {
          "description": "The relevant CWEs.",
          "items": {
            "$ref": "#/definitions/CWEString"
          },
          "type": "array"
        },
        "patchBase": {
          "$ref": "#/definitions/CommitDescription",
          "description": "The patchBase commit.",
          "title": "patchBase"
        },
        "postPatch": {
          "$ref": "#/definitions/CommitDescription",
          "description": "The postPatch commit."
        },
        "repository": {
          "$ref": "#/definitions/URLString",
          "description": "The URL to the repository that hosts the commits."
        },
        "state": {
          "$ref": "#/definitions/CVEState",
          "description": "The CVE state of the CVE"
        }
      },
      "required": [
        "CVE"
      ],
      "title": "BCVE",
      "type": "object"
    },
    "BCVEAlert": {
      "additionalProperties": false,
      "description": "An alert raised by an analysis tool.",
      "properties": {
        "explanation": {
          "description": "An explanation for this weakness.",
          "type": "string"
        },
        "format": {
          "const": "simple",
          "description": "The data format.",
          "type": "string"
        },
        "location": {
          "$ref": "#/definitions/SourceLocation",
          "description": "The source location of the weakness, relative to the root of the vulnerable project"
        },
        "ruleID": {
          "$ref": "#/definitions/RuleID",
          "description": "The ID of the rule that produced this alert."
        },
        "url": {
          "description": "The URL for additional information about the rule that produced this alert.",
          "type": "string"
        }
      },
      "required": [
        "explanation",
        "format"
      ],
      "title": "BCVEAlert",
      "type": "object"
    },
    "BCVELog": {
      "additionalProperties": false,
      "description": "A collection of analysis tool runs.",
      "properties": {
        "runs": {
          "description": "The runs.",
          "items": {
            "$ref": "#/definitions/StandaloneRun"
          },
          "type": "array"
        }
      },
      "required": [
        "runs"
      ],
      "title": "BCVELog",
      "type": "object"
    },
    "BCVEResultStatus": {
      "description": "A status for a run of an analysis tool.",
      "enum": [
        "SUCCESS",
        "TIMEOUT",
        "CRASH",
        "UNSUPPORTED_SOURCE",
        "UNSUPPORTED_CVE",
        "NO_SOURCES"
      ],
      "title": "BCVEResultStatus",
      "type": "string"
    },
    "BCVERun": {
      "additionalProperties": false,
      "description": "A run of an analysis tool on some source code.",
      "properties": {
        "alerts": {
          "description": "The alerts produced by the tool.",
          "items": {
            "$ref": "#/definitions/BCVEAlert"
          },
          "type": "array"
        },
        "reproduction": {
          "description": "A command-line string that enables reproduction of the run independent of the benchmarking tooling.",
          "type": "string"
        },
        "status": {
          "$ref": "#/definitions/BCVEResultStatus",
          "description": "The final status for the run."
        },
        "toolID": {
          "$ref": "#/definitions/ToolID",
          "description": "An ID for the tool of the run."
        }
      },
      "required": [
        "toolID",
        "status"
      ],
      "title": "BCVERun",
      "type": "object"
    },
    "CVEState": {
      "description": "The state of a CVE.",
      "enum": [
        "ACCEPTED",
        "DISPUTED",
        "REJECTED",
        "RESERVED"
      ],
      "title": "CVEState",
      "type": "string"
    },
    "CVEString": {
      "type": "string"
    },
    "CWEString": {
      "type": "string"
    },
    "CommitDescription": {
      "additionalProperties": false,
      "description": "A description of a commit that is related to a CVE.",
      "properties": {
        "commit": {
          "$ref": "#/definitions/CommitID",
          "description": "The commit."
        },
        "localSourceDirectory": {
          "$ref": "#/definitions/Dir",
          "description": "The local source directory whe the source code for this commit is located, if any."
        },
        "runs": {
          "description": "A collection of analysis tool runs for this commit, if any.",
          "items": {
            "$ref": "#/definitions/BCVERun"
          },
          "type": "array"
        },
        "weaknesses": {
          "description": "The weaknesses related to the CVE of this commit, if any.",
          "items": {
            "$ref": "#/definitions/Weakness"
          },
          "type": "array"
        }
      },
      "required": [
        "commit"
      ],
      "title": "CommitDescription",
      "type": "object"
    },
    "CommitID": {
      "type": "string"
    },
    "Config": {
      "additionalProperties": false,
      "description": "A configuration object.",
      "properties": {
        "bcvesDir": {
          "$ref": "#/definitions/Dir",
          "description": "The directory where the Benchmark CVEs are located."
        },
        "exportFile": {
          "$ref": "#/definitions/File",
          "description": "The file that is exported to."
        },
        "reportFormat": {
          "$ref": "#/definitions/Format",
          "description": "The preferred output format of the report that is generated."
        },
        "reportName": {
          "description": "The name of the report to generate.",
          "type": "string"
        },
        "reportsDir": {
          "$ref": "#/definitions/Dir",
          "description": "The directory where the reports are located."
        },
        "resultsDir": {
          "$ref": "#/definitions/Dir",
          "description": "The directory where the results for the analysis tool runs are located."
        },
        "sourcesDir": {
          "$ref": "#/definitions/Dir",
          "description": "The directory where the source code for the CVEs are located."
        },
        "tools": {
          "additionalProperties": {
            "$ref": "#/definitions/PluginSpecificOptions",
            "description": "The name of the analysis tool, and the associated options."
          },
          "description": "The configurations of the analysis tools.",
          "type": "object"
        },
        "viewerRepo": {
          "description": "The code-scanning enabled GitHub repositovy to display tool results at",
          "type": "string"
        }
      },
      "title": "Config",
      "type": "object"
    },
    "Dir": {
      "type": "string"
    },
    "Export": {
      "description": "A collection of exported benchmark CVEs.",
      "items": {
        "$ref": "#/definitions/BCVE"
      },
      "title": "Export",
      "type": "array"
    },
    "File": {
      "type": "string"
    },
    "Format": {
      "description": "An output format for a report.",
      "enum": [
        "txt",
        "md",
        "html",
        "csv"
      ],
      "type": "string"
    },
    "InterpolatableString": {
      "type": "string"
    },
    "PluginSpecificOptions": {
      "description": "A value that an analysis tool plugin knows how to interpret.",
      "title": "PluginSpecificOptions"
    },
    "RuleID": {
      "type": "string"
    },
    "SourceLocation": {
      "additionalProperties": false,
      "description": "A sourc location.",
      "properties": {
        "file": {
          "$ref": "#/definitions/File",
          "description": "The path to the file."
        },
        "line": {
          "description": "The line number.",
          "type": "number"
        }
      },
      "required": [
        "file",
        "line"
      ],
      "title": "SourceLocation",
      "type": "object"
    },
    "StandaloneRun": {
      "additionalProperties": false,
      "description": "A run of an analysis tool on a commit related to a CVE.",
      "properties": {
        "CVE": {
          "$ref": "#/definitions/CVEString",
          "description": "The CVE identifier."
        },
        "alerts": {
          "description": "The alerts produced by the tool.",
          "items": {
            "$ref": "#/definitions/BCVEAlert"
          },
          "type": "array"
        },
        "commit": {
          "$ref": "#/definitions/CommitID",
          "description": "The commit."
        },
        "reproduction": {
          "description": "A command-line string that enables reproduction of the run independent of the benchmarking tooling.",
          "type": "string"
        },
        "status": {
          "$ref": "#/definitions/BCVEResultStatus",
          "description": "The final status for the run."
        },
        "toolID": {
          "$ref": "#/definitions/ToolID",
          "description": "An ID for the tool of the run."
        }
      },
      "required": [
        "CVE",
        "commit",
        "status",
        "toolID"
      ],
      "title": "StandaloneRun",
      "type": "object"
    },
    "ToolID": {
      "type": "string"
    },
    "ToolName": {
      "type": "string"
    },
    "URLString": {
      "type": "string"
    },
    "Weakness": {
      "additionalProperties": false,
      "description": "A weakness in some source code.",
      "properties": {
        "explanation": {
          "description": "An explanation for this weakness.",
          "type": "string"
        },
        "format": {
          "const": "simple",
          "description": "The data format.",
          "type": "string"
        },
        "location": {
          "$ref": "#/definitions/SourceLocation",
          "description": "The source location of the weakness, relative to the root of the vulnerable project"
        }
      },
      "required": [
        "format",
        "explanation"
      ],
      "title": "Weakness",
      "type": "object"
    }
  },
  "$id": "https://github.com/ossf/cve-benchmark/schemas/ts-defs.schema.json",
  "title": "Generated schema types"
}

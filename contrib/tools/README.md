# contrib/tools

This directory contains analysis tool plugins that has been
contributed by the community. The naming of these directories do not
matter, and analysis tool plugins do not have to be in this directory
at all.

Analysis tools plugins are small scripts that run an actual analysis
tool when invoked by `bin/cli run ...`.

To add out-of-the-box support for a new analysis tool plugin, add a new
directory to the [contrib/tools](.) directory, then do the following
in that directory:

- Add a `README.md` file that describes how the analysis tool can be
  installed, and how the plugin can be configured.
- Optionally, add an executable `bin/install.sh` or `bin/install.cmd`
  script that can install a version of the analysis tool. See
  [eslint/bin/install.sh](eslint/bin/install.sh) as an example.


## TODO

## Installing analysis tool plugins

It is recommended, but not required, that the plugin implementation
makes use of the TypeScript libraries in this repository to avoid
reimplementing the logic around running an analysis tool on multiple
CVEs. See [eslint.ts](eslint/src/eslint.ts) as an example that uses
[driver.ts](/src/driver.ts).

The `bin/run` script does not have to be runnable by all users of this
project, although it is heavily encouraged. If `bin/run` invokes a
proprietary analysis tool in undocumented ways, it is for instance
fine to also keep the majority plugin away from public eyes.

## Implementing analysis tool plugins




## Provided Input to `bin/run`

When `bin/run` is invoked through `bin/cli run ...`, it receives four positional arguments:

1. `version`: a version string that indicates the analysis tool that should be run
2. `output`: a path to a directory that the processed results of the analysis tool should be emitted to
3. `input`: a path to a json file with an array of benchmark CVEs that the analysis tool should be run on
4. `options`: a path to an options file for the plugin, as extracted from the configuration of the `bin/cli run` command

## Expected output of `bin/run`

When `bin/run` is invoked through `bin/cli run ...`, it should emit
some number of file to the provided `output` directory. It is up to
`bin/run` how it names these files, but the should be valid according to
[Log.schema.json](/schemas/Log.schema.json)

Example:
```json
{
  "CVE": "CVE-2020-4066",
  "commit": "ba6a6f13691000ffaf22ef8e731513737659447f",
  "runs": [
    {
      "toolID": "eslint@latest",
      "alerts": [ ... ],
      "status": "SUCCESS", 
      "reproduction": "...
    }
  ]
}
```

## Behaviour of the `driver.ts` helper 

[driver.ts](src/driver.ts) exports utilities that eases the
implementation of `run.sh` using TypeScript. For details, see the
documentatino of [driver.ts](src/driver.ts) itself.

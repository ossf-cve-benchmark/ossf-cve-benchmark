# contrib/tools/codeql 

This directory contains the driver for running the
[`codeql`](https://github.com/github/codeql) analysis tool.

## Installation

To make use of this driver, you need `codeql` and its query packs on
the local machine. This can be achieved with
[installers/install.sh](./installers/install.sh) which simply installs
the latest public `codeql` bundle.

For convenience, a file with manually maintained information about the
relevant `codeql` query and language for each CVE must also be
downloaded. Alternatively, the driver implementation would need to run
all queries or infer the relevant queries from local information.

## Configuration

To make use of the local `codeql`, add a tools entry in the config file 
as instructed by the install script above. 

```json
{
  ...
  "tools": {
    ...

    "codeql-default": {
      "bin": "node",
      "args": [
      "/home/user-name/ossf-cve-benchmark/build/ts/contrib/tools/codeql/src/codeql.js",
      ],
      "options": {
        "codeql": "/home/user-name/analysis-tools/codeql-default/codeql/codeql",
        "cveInformation": "/home/user-name/analysis-tools/codeql-default/cve-information.json"
      }
    },
    ...
  }
  ...
}
```

This will allow you to use the tool-id `codeql-default` in `cli/bin run
--tool codeql-default -`.  To use another version of `codeql`,
install it, and add another configuration entry that uses that:

```json
    ...
    "codeql-2020": {
      "bin": "node",
      "args": [
        "/home/user-name/ossf-cve-benchmark/build/ts/contrib/tools/codeql/src/codeql.js",
      ],
      "options": {
        "codeql": "/home/user-name/analysis-tools/codeql-2020/codeql/codeql",
        "cveInformation": "/home/user-name/analysis-tools/codeql-2020/cve-information.json"
      }
    },
    ...
```


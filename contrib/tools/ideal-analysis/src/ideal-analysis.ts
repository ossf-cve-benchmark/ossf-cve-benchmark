/**
 * This is the trivial driver for the ideal analysis that simply reports all of the known weaknesses.
 */
import { AnalyzeParams, drive } from "../../../../src/driver";
import { BCVEResultStatus } from "../../../../src/persistent-types";

drive(async function analyze({
  bcve,
  commitDescription,
  setAlerts,
  setStatus
}: AnalyzeParams) {
  setAlerts(
    (commitDescription.weaknesses || []).map(w => ({
      ruleID: `rule-for-${bcve.CVE}`,
      location: { file: w.location.file, lines: [w.location.line] }
    }))
  );
  setStatus(BCVEResultStatus.SUCCESS);
},
false)
  .then(() => process.exit(0))
  .catch(e => {
    console.error(e);
    process.exit(1);
  });

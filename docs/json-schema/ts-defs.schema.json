{"$schema":"http://json-schema.org/draft-07/schema#","definitions":{"BCVE":{"additionalProperties":false,"description":"A benchmark CVE.\n\nSee docs/benchmark-CVEs.md for an in-depth explanation of this type.","properties":{"CVE":{"$ref":"#/definitions/CVEString","description":"The CVE identifier."},"CWEs":{"description":"The relevant CWEs for the weaknesses.","items":{"$ref":"#/definitions/CWEString"},"type":"array"},"postPatch":{"$ref":"#/definitions/CommitDescription","description":"The postPatch commit."},"prePatch":{"$ref":"#/definitions/CommitDescription","description":"The prePatch commit.","title":"prePatch"},"repository":{"$ref":"#/definitions/RepositoryIdentifier","description":"The string that identifies the repository that hosts the commits."},"state":{"$ref":"#/definitions/CVEState","description":"The CVE state of the CVE"}},"required":["CVE","state","repository","prePatch","postPatch"],"title":"BCVE","type":"object"},"BCVEAlert":{"additionalProperties":false,"description":"An alert raised by an analysis tool.","properties":{"location":{"$ref":"#/definitions/SourceLocation","description":"The source location of the weakness, relative to the root of the vulnerable project"},"ruleID":{"$ref":"#/definitions/RuleID","description":"The ID of the rule that produced this alert."},"url":{"description":"The URL for additional information about this alert.","type":"string"}},"required":["location","ruleID"],"title":"BCVEAlert","type":"object"},"BCVELog":{"additionalProperties":false,"description":"A collection of analysis tool runs.","properties":{"runs":{"description":"The runs.","items":{"$ref":"#/definitions/StandaloneRun"},"type":"array"}},"required":["runs"],"title":"BCVELog","type":"object"},"BCVEResultStatus":{"description":"A simple status for a run of an analysis tool.\n\nThe run itself should contain enough information to reproduce the missing details.","enum":["SUCCESS","TIMEOUT","CRASH","UNSUPPORTED","FRAMEWORK_ERROR"],"title":"BCVEResultStatus","type":"string"},"BCVERun":{"additionalProperties":false,"description":"A run of an analysis tool on some source code.","properties":{"alerts":{"description":"The alerts produced by the tool.","items":{"$ref":"#/definitions/BCVEAlert"},"type":"array"},"reproduction":{"description":"A command-line string that enables reproduction of the run independent of the benchmarking tooling.","type":"string"},"status":{"$ref":"#/definitions/BCVEResultStatus","description":"The final status for the run."},"toolID":{"$ref":"#/definitions/ToolID","description":"An ID for the tool of the run."}},"required":["toolID","status"],"title":"BCVERun","type":"object"},"CVEState":{"description":"The state of a CVE. See https://cve.mitre.org/about/terminology.html#cve_record","enum":["PUBLISHED","DISPUTED","REJECTED","RESERVED"],"title":"CVEState","type":"string"},"CVEString":{"type":"string"},"CWEString":{"type":"string"},"CommitDescription":{"additionalProperties":false,"description":"A description of a commit that is related to a CVE.","properties":{"commit":{"$ref":"#/definitions/CommitID","description":"The commit."},"localSourceDirectory":{"$ref":"#/definitions/Dir","description":"The local source directory whe the source code for this commit is located, if any."},"runs":{"description":"A collection of analysis tool runs for this commit, if any.","items":{"$ref":"#/definitions/BCVERun"},"type":"array"},"weaknesses":{"description":"The weaknesses related to the CVE of this commit, if any.","items":{"$ref":"#/definitions/Weakness"},"type":"array"}},"required":["commit"],"title":"CommitDescription","type":"object"},"CommitID":{"type":"string"},"Config":{"additionalProperties":false,"description":"A configuration object.","properties":{"bcves":{"$ref":"#/definitions/Dir","description":"The directory where the Benchmark CVEs are located."},"canonical-repositories-root":{"description":"The location where canonical repositories exists for each CVE as `<root>/<CVE>.git`.","type":"string"},"config-file":{"$ref":"#/definitions/File","description":"The configuration file that defines (some of) these values."},"export":{"$ref":"#/definitions/File","description":"The file that is exported to."},"reports":{"$ref":"#/definitions/Dir","description":"The directory where the reports are located."},"results":{"$ref":"#/definitions/Dir","description":"The directory where the results for the analysis tool runs are located."},"sources":{"$ref":"#/definitions/Dir","description":"The directory where the source code for the CVEs are located."},"tools":{"additionalProperties":{"$ref":"#/definitions/DriverConfig%3Cany%3E","description":"The name of the driver, and the associated options."},"description":"The configurations of the analysis tool drivers.","type":"object"}},"title":"Config","type":"object"},"Dir":{"description":"This file contains the types used for persistent data in this project: most notably the CVE benchmark data and analysis results for them.\n\nThis file should not contain types for values that are not going to be persisted.\n\nJSON schemas and associated documentation will be generated from this file, so everything ought to be documented thoroughly.","type":"string"},"DriverConfig<any>":{"additionalProperties":false,"description":"A configuration for how to run an analysis tool driver.","properties":{"args":{"description":"The leading arguments to execute the `bin` with. These arguments are followed by a single argument with a run-specific input file.","items":{"type":"string"},"type":"array"},"bin":{"description":"The binary to execute with the `run` command.","type":"string"},"options":{"description":"Additional options for the driver (preferred over a long `args` arrray)."},"timeout":{"description":"The time in milliseconds that the driver will permit the analysis tool to analyze a commit in.","type":"number"}},"required":["bin","args"],"title":"DriverConfig","type":"object"},"DriverInputs":{"additionalProperties":false,"description":"The inputs accessible to the drivers that are executed by the `run` command (the inputs are provided as a JSON file, pointed to by the last commandline argument).","properties":{"bcves":{"description":"The benchmark CVEs to analyze.","items":{"$ref":"#/definitions/BCVE"},"type":"array"},"config":{"$ref":"#/definitions/Config","description":"The effective configuration used by the Benchmarker."},"toolID":{"$ref":"#/definitions/ToolID","description":"The ID of the tool that is being run."}},"required":["toolID","bcves","config"],"type":"object"},"Export":{"description":"A collection of exported benchmark CVEs.","items":{"$ref":"#/definitions/BCVE"},"title":"Export","type":"array"},"File":{"type":"string"},"RepositoryIdentifier":{"type":"string"},"RuleID":{"type":"string"},"SourceLocation":{"additionalProperties":false,"description":"A source location.","properties":{"file":{"$ref":"#/definitions/File","description":"The path to the file."},"line":{"description":"The line number.","type":"number"}},"required":["file","line"],"title":"SourceLocation","type":"object"},"StandaloneRun":{"additionalProperties":false,"description":"A run of an analysis tool on a commit related to a CVE.","properties":{"CVE":{"$ref":"#/definitions/CVEString","description":"The CVE identifier."},"alerts":{"description":"The alerts produced by the tool.","items":{"$ref":"#/definitions/BCVEAlert"},"type":"array"},"commit":{"$ref":"#/definitions/CommitID","description":"The commit."},"reproduction":{"description":"A command-line string that enables reproduction of the run independent of the benchmarking tooling.","type":"string"},"status":{"$ref":"#/definitions/BCVEResultStatus","description":"The final status for the run."},"toolID":{"$ref":"#/definitions/ToolID","description":"An ID for the tool of the run."}},"required":["CVE","commit","status","toolID"],"title":"StandaloneRun","type":"object"},"ToolID":{"type":"string"},"Weakness":{"additionalProperties":false,"description":"A weakness in some source code.","properties":{"explanation":{"description":"An explanation for this weakness.","type":"string"},"location":{"additionalProperties":false,"description":"The source location of the weakness, relative to the root of the vulnerable project","properties":{"file":{"$ref":"#/definitions/File","description":"The path to the file."},"implicitExtension":{"description":"The implicit file extension of `file`, e.g. 'js' or 'sh'","type":"string"},"line":{"description":"The line number.","type":"number"}},"required":["file","line"],"type":"object"}},"required":["location","explanation"],"title":"Weakness","type":"object"}},"$id":"https://github.com/ossf-cve-benchmark/ossf-cve-benchmark/schemas/ts-defs.schema.json","title":"Generated schema types from src/persistent-types.ts"}

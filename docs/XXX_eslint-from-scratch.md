# ESLint from scratch

XXX This documents is a reference document for the ongoing documentation efforts.

## Content

To run the [`eslint`](https://eslint.org/) analysis tool on the commits
of a CVE, and view the reports, the following steps must be taken:

### Initializing the repository 

This is the same as in [README.md](../README.md)
```
$ git clone git@github.com:ossf-cve-benchmark/ossf-cve-benchmark.git
$ cd ossf-cve-benchmark
$ npm i
$ npm run-script build
```

### Installing and configuring `eslint`

With the `bin/cli tools` command it can be seen that there is an
installer for `eslint`. Drivers are encouraged
to include installers, but some may opt to only include a README.md
with some manual steps.

```
bin/cli tools
Configured:
...

Available, with installer:
- contrib/tools/eslint/bin/install.cmd
- contrib/tools/eslint/bin/install.sh

...
```

We run the installer, and see what happens:

```
$ contrib/tools/eslint/bin/install.sh
Missing an argument.
Usage: contrib/tools/eslint/bin/install.sh directory-to-install-eslint-in
```

We try again:

```
$ contrib/tools/eslint/bin/install.sh /tmp/eslint-installation-directory
Wrote to /tmp/eslint-installation-directory/package.json:

{
  "name": "eslint-installation-directory",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}



added 115 packages, and audited 115 packages in 3s

9 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
The eslint tool has been installed. Add the fragment below to a config.json file:

{
    ...
    "tools": {
        ...

        "eslint-default": {
            "bin": "node",
            "args": [
                "/home/esben/_data/ossf-cve-benchmarking/build/ts/contrib/tools/eslint/src/eslint.js",
                "/tmp/eslint-installation-directory"
            ]
        }

        ...
    }
    ...
}
```
`eslint` is now installed, but not yet configured. See the instruction at the end of the output.

We put that bit into our local `config.json`:

```
{
    "tools": {
        "eslint-default": {
            "bin": "node",
            "args": [
                "/home/esben/_data/ossf-cve-benchmarking/build/ts/contrib/tools/eslint/src/eslint.js",
                "/tmp/eslint-installation-directory"
            ]
        }
    }
}
```

We check that `eslint` has been configured:

```
$ bin/cli --build tools
Configured:
- eslint-default
...
```


### Running `eslint`

We are now in a position where we can run the `eslint-default` driver with `bin/cli run`, we choose to do that on two commits.

```
$ bin/cli run --tool eslint-default CVE-2018-16492 CVE-2020-4066
...
```

(at the moment, you need to have run `bin/cli download-commits CVE-2018-16492 CVE-2020-4066` first, but that requirement will disappear soon)

After a (short) while, result files will be written to disk (by default `work/results/eslint-default_....json` x4), and the command Will terminate.

### Creating reports for the runs

This is the same as in [README.md](../README.md)

```
$ bin/cli report --kind server --tool eslint-default CVE-2018-16492 CVE-2020-4066
```
After which, the report can be accessed at https://localhost:8080.

```
$ bin/cli report --kind txt --tool eslint-default CVE-2018-16492 CVE-2020-4066
```
After which, the reports can be seen in `work/reports`.

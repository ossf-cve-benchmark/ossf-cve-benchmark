import { parse } from "./selectors";

describe("CVE selector parsing", () => {
  describe("All selector kinds are supported", () => {
    [
      "*",
      "CVE-2020-15119",
      "year:2020",
      "ext:js",
      "CWE-079",
      "mitre-cwe-top:25:2020",
      "incomplete"
    ].forEach(argLine =>
      test(`'${argLine}' is supported`, () => {
        let parsed = parse(argLine);
        expect(parsed).toBeTruthy();
        expect(parsed.toString()).toBeTruthy();
      })
    );
  });
  test("Unsupported selectors throws", () => {
    expect(() => parse("")).toThrow();
    expect(() => parse("not-a-selector")).toThrow();
  });
});
